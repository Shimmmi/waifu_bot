# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞

## –û–ø–∏—Å–∞–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞ –≤–∞–π—Ñ—É: –æ–¥–∏–Ω —Ä–∞–∑ –≤ –¥–µ–Ω—å (–∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ –ø—Ä–∏–∑–≤–∞—Ç—å –æ–¥–Ω—É –≤–∞–π—Ñ—É.

## –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å SQL –º–∏–≥—Ä–∞—Ü–∏—é

–û—Ç–∫—Ä–æ–π—Ç–µ Neon Console –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç:

```sql
-- Migration 014: Add free summon tracking
-- Adds last_free_summon timestamp to track daily free summon cooldown

ALTER TABLE users 
ADD COLUMN IF NOT EXISTS last_free_summon TIMESTAMPTZ DEFAULT TIMESTAMPTZ '1970-01-01';

-- Set default value for existing users (allows immediate free summon)
UPDATE users 
SET last_free_summon = TIMESTAMPTZ '1970-01-01' 
WHERE last_free_summon IS NULL;

COMMENT ON COLUMN users.last_free_summon IS 'Timestamp of last free summon (1 per 24 hours)';
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```sql
SELECT id, tg_id, username, last_free_summon 
FROM users 
LIMIT 5;
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª–µ `last_free_summon` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è.

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### Backend (src/bot/)

1. **models.py**: –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `last_free_summon` –≤ –º–æ–¥–µ–ª—å `User`
2. **api_server.py**: 
   - –û–±–Ω–æ–≤–ª–µ–Ω `/api/summon` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞
   - –û–±–Ω–æ–≤–ª–µ–Ω `/api/profile` –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ç–∞—Ç—É—Å–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞

### Frontend (webapp/)

1. **app.js**:
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `formatCooldown()` –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ cooldown
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `loadWaifuList()` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `renderWaifuList()` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏ "–ë–ï–°–ü–õ–ê–¢–ù–û" –∏–ª–∏ cooldown
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `summonWaifu()` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Å–ª–µ –ø—Ä–∏–∑—ã–≤–∞

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü–µ—Ä–≤—ã–π –ø—Ä–∏–∑—ã–≤**: –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø—Ä–∏–∑—ã–≤ (–∏–ª–∏ –ø—Ä–æ—à–ª–æ 24 —á–∞—Å–∞), –∫–Ω–æ–ø–∫–∞ –ø—Ä–∏–∑—ã–≤–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "üéÅ –ë–ï–°–ü–õ–ê–¢–ù–û" —Å –∑–µ–ª–µ–Ω—ã–º —Ñ–æ–Ω–æ–º.

2. **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø—Ä–∏–∑—ã–≤**: –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ü—Ä–∏–∑–≤–∞—Ç—å 1 –≤–∞–π—Ñ—É" (–∫–æ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø—Ä–∏–∑—ã–≤), –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –≤–∞–π—Ñ—É –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –∞ `last_free_summon` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è.

3. **Cooldown**: –ü–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞, –∫–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, "100üí∞") –∏ –≤—Ä–µ–º—è –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "23—á 45–º").

4. **–û–±—ã—á–Ω—ã–π –ø—Ä–∏–∑—ã–≤**: –ï—Å–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø—Ä–∏–∑—ã–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–∏–∑–≤–∞—Ç—å –≤–∞–π—Ñ—É –∑–∞ –º–æ–Ω–µ—Ç—ã, –∏—Å–ø–æ–ª—å–∑—É—è –æ–±—ã—á–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–¢–µ—Å—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞**:
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É "–í–∞–π—Ñ—É"
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –ø—Ä–∏–∑—ã–≤–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "üéÅ –ë–ï–°–ü–õ–ê–¢–ù–û"
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –ø—Ä–∏–∑—ã–≤–∞
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–∞–π—Ñ—É –ø—Ä–∏–∑–≤–∞–Ω–∞ –±–µ–∑ —Å–ø–∏—Å–∞–Ω–∏—è –º–æ–Ω–µ—Ç

2. **–¢–µ—Å—Ç cooldown**:
   - –ü–æ—Å–ª–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞, –∫–Ω–æ–ø–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Ä–µ–º—è cooldown –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

3. **–¢–µ—Å—Ç –æ–±—ã—á–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞**:
   - –ï—Å–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø—Ä–∏–∑—ã–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–∏–∑—ã–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ –º–æ–Ω–µ—Ç—ã

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø—Ä–∏–∑—ã–≤ –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–∏–∑—ã–≤–∞ **1 –≤–∞–π—Ñ—É**, –Ω–µ –¥–ª—è x10
- Cooldown —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç **24 —á–∞—Å–∞** (86400 —Å–µ–∫—É–Ω–¥)
- –°—Ç–∞—Ç—É—Å –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–í–∞–π—Ñ—É"
- –ü–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
